<!DOCTYPE html>
<html>
<head>
    <title>LOCATION
    </title>

    <script src='/socket.io/socket.io.js'></script>
    <script>
        var socket = io.connect('http://localhost:50000');
        socket.on('udp message', function (msg) {
            var coord = msg.split(",");
            latitud = coord[0];
            longitud = coord[1];
            fecha = coord[2];
            console.log(msg);
        });
        
    </script>
    <style>
         #map {
  height: 100%;
  width: 100%;
  position:absolute;
  top: 0;
  left: 0;
  z-index: 0; /* Set z-index to 0 as it will be on a layer below the contact form */
    }
        
   </style>
</head>
<body> 
    <div style="position:absolute; top:110px; left:0px; z-index:5; width:410px; height:400px; background-color:#CDCDCD; opacity:0.9"> 
    <font color=#000000>
        <h1 style= "font-size:1cm;font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif; position:absolute; z-index: 10; left:1cm; top: 10px;" ><i>LOCATION</i></h1>
    </font>
    <font color=#000000>
        <h2 style= "font-size:0.5cm;font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif; position:absolute; z-index: 10; left:1cm; top: 100px;" ><i>-Latitud:</i></h2>
    </font>
    <font color=#000000>
        <h2 style= "font-size:0.4cm;font-family:'Times New Roman', Times, serif; position:absolute; z-index: 10; left:3cm; top: 97px;" ><p id="lat"></p></h2>
    </font>
    <font color=#000000>
        <h3 style= "font-size:0.5cm;font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif; position:absolute; z-index: 10; left:1cm; top: 140px;" ><i>-Longitud:</i></h3>
    </font>
    <font color=#000000>
        <h3 style= "font-size:0.4cm;font-family:'Times New Roman', Times, serif; position:absolute; z-index: 10; left:3.5cm; top: 137px;" ><p id="long"></p></h3>
    </font>
    <font color=#000000>
        <h4 style= "font-size:0.5cm;font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif; position:absolute; z-index: 10; left:1cm; top: 180px;" ><i>-Timestamp:</i></h4>
    </font>
    <font color=#000000>
        <h4 style= "font-size:0.4cm;font-family:'Times New Roman', Times, serif; position:absolute; z-index: 10; left:4cm; top: 177px;" ><p id="timestamp"></p></h4>
    </font>



    <form 
        style="position:absolute; top:250px; left:10px; z-index: 10;"


        name="formulario_fecha" id="formulario_fecha" method="post"
         action="send.php" autocomplete="off">


        <label for="inicio">Selecciona la fecha y hora del inicio del recorrido:</label>
        <input type="datetime-local" name="inicio" required><br>
        <label for="fin">Selecciona la fecha y hora del fin del recorrido:</label>
        <input type="datetime-local" name="fin" required><br><br>
        <input type="submit" value="Submit">
      </form>
    </div>
    
    
    

    <div id="map"></div>
    <script >
        var pathCoordinates = Array();
        function initMap() {
        var coord = {lat:10.949185 ,lng: -74.803391};
        var map = new google.maps.Map(document.getElementById('map'),{
          zoom: 10, center: coord
        });
    
        var marker = new google.maps.Marker({
          position: coord,
          map: map
        });
        update = setInterval(function () {
            document.getElementById("lat").innerHTML = latitud;
            document.getElementById("long").innerHTML = longitud;
            document.getElementById("timestamp").innerHTML = fecha;

            var numlat = parseFloat(latitud);
            var numlon = parseFloat(longitud);

            var options = {
                center:{lat:numlat, lng:numlon}
            }

            pathCoordinates.push({
                                        lat : numlat,
                                        lng : numlon
            });

            map.setOptions(options);
            marker.setPosition({lat:numlat, lng:numlon});

            new google.maps.Polyline({
                        path : pathCoordinates,
                        geodesic : true,
                        strokeColor : '#FF0000',
                        strokeOpacity : 1,
                        strokeWeight : 4,
                        map : map
                });

        }, 1000); //es lo minimo


    }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBQBGTBKMtCmEGfBu9YqHhXNpHIDormd9o&callback=initMap"></script>
</body>
</html>
